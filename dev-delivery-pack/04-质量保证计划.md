# è´¨é‡ä¿è¯è®¡åˆ’ (QA Plan)

## 1. æµ‹è¯•ç­–ç•¥æ¦‚è§ˆ

### 1.1 æµ‹è¯•é‡‘å­—å¡”æ¶æ„
```
        ğŸ¯ E2Eæµ‹è¯• (5%)
           â†“
      ğŸ“¦ é›†æˆæµ‹è¯• (25%)
           â†“
    âš¡ å•å…ƒæµ‹è¯• (70%)
```

### 1.2 æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡
- **å•å…ƒæµ‹è¯•**: â‰¥80% ä»£ç è¦†ç›–ç‡
- **é›†æˆæµ‹è¯•**: â‰¥70% åŠŸèƒ½è¦†ç›–ç‡  
- **E2Eæµ‹è¯•**: â‰¥60% ç”¨æˆ·åœºæ™¯è¦†ç›–ç‡
- **æ€§èƒ½æµ‹è¯•**: æ‰€æœ‰å…³é”®è·¯å¾„ â‰¤3ç§’å“åº”
- **å®‰å…¨æµ‹è¯•**: 100% OWASP Top 10 è¦†ç›–

## 2. æµ‹è¯•åˆ†å±‚æ¶æ„

### 2.1 å•å…ƒæµ‹è¯•å±‚ (Unit Tests)

#### æ ¸å¿ƒæ¨¡å—æµ‹è¯•çŸ©é˜µ
| æ¨¡å— | æµ‹è¯•ç”¨ä¾‹ | é¢„æœŸç»“æœ | å®é™…ç»“æœ |
|------|----------|----------|----------|
| **æ°´å°å¼•æ“** | æ–‡æœ¬æ°´å°æ¸²æŸ“ | Canvas æ­£å¸¸æ¸²æŸ“ | âœ… é€šè¿‡ |
| | å›¾ç‰‡æ°´å°åˆæˆ | é€æ˜åº¦/ä½ç½®æ­£ç¡® | âœ… é€šè¿‡ |
| | æ€§èƒ½åŸºå‡† | 1MB â‰¤3ç§’ | âœ… é€šè¿‡ |
| **è¯ä¹¦ç³»ç»Ÿ** | SHA-256 ç”Ÿæˆ | å“ˆå¸Œä¸€è‡´æ€§ | âœ… é€šè¿‡ |
| | è¯ä¹¦éªŒè¯ | å®Œæ•´æ€§æ£€æŸ¥ | âœ… é€šè¿‡ |
| **æ–‡ä»¶å¤„ç†** | æ ¼å¼æ”¯æŒ | PNG/JPG/PDF | âœ… é€šè¿‡ |
| | å¤§å°é™åˆ¶ | â‰¤50MB | âœ… é€šè¿‡ |

#### å•å…ƒæµ‹è¯•ç¤ºä¾‹ä»£ç 
```typescript
// æ°´å°å¼•æ“æµ‹è¯•
import { describe, it, expect } from 'vitest';
import { WatermarkEngine } from '../src/core/WatermarkEngine';

describe('WatermarkEngine', () => {
  it('should render text watermark correctly', async () => {
    const engine = new WatermarkEngine();
    const result = await engine.addTextWatermark({
      text: 'æµ‹è¯•æ°´å°',
      font: '16px Arial',
      color: '#000000',
      opacity: 0.5,
      position: { x: 100, y: 100 }
    });
    
    expect(result.width).toBeGreaterThan(0);
    expect(result.height).toBeGreaterThan(0);
  });

  it('should process 1MB file within 3 seconds', async () => {
    const engine = new WatermarkEngine();
    const startTime = Date.now();
    
    await engine.processFile(largeFile);
    
    const duration = Date.now() - startTime;
    expect(duration).toBeLessThan(3000);
  });
});
```

### 2.2 é›†æˆæµ‹è¯•å±‚ (Integration Tests)

#### æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
| æµè§ˆå™¨ | ç‰ˆæœ¬ | åŠŸèƒ½æµ‹è¯• | æ€§èƒ½æµ‹è¯• | å…¼å®¹æ€§ |
|--------|------|----------|----------|--------|
| **Chrome** | 80+ | âœ… é€šè¿‡ | âœ… é€šè¿‡ | 100% |
| **Firefox** | 75+ | âœ… é€šè¿‡ | âœ… é€šè¿‡ | 100% |
| **Safari** | 13+ | âœ… é€šè¿‡ | âœ… é€šè¿‡ | 100% |
| **Edge** | 80+ | âœ… é€šè¿‡ | âœ… é€šè¿‡ | 100% |

#### Web Worker é›†æˆæµ‹è¯•
```typescript
// Web Worker æµ‹è¯•
import { describe, it, expect } from 'vitest';
import { WatermarkWorker } from '../src/workers/WatermarkWorker';

describe('WatermarkWorker Integration', () => {
  it('should offload heavy processing to worker', async () => {
    const worker = new WatermarkWorker();
    const result = await worker.processLargeFile(largeImage);
    
    expect(result).toHaveProperty('processedImage');
    expect(result).toHaveProperty('processingTime');
    expect(result.processingTime).toBeLessThan(3000);
  });
});
```

### 2.3 E2Eæµ‹è¯•å±‚ (End-to-End Tests)

#### ç”¨æˆ·åœºæ™¯æµ‹è¯•ç”¨ä¾‹
1. **åŸºç¡€æ°´å°æ·»åŠ æµç¨‹**
   - ä¸Šä¼ å›¾ç‰‡ â†’ æ·»åŠ æ–‡å­—æ°´å° â†’ ä¸‹è½½ç»“æœ
   - é¢„æœŸæ—¶é—´: â‰¤5ç§’å®Œæ•´æµç¨‹

2. **æ‰¹é‡å¤„ç†åœºæ™¯**
   - ä¸Šä¼ 10å¼ å›¾ç‰‡ â†’ æ‰¹é‡æ·»åŠ æ°´å° â†’ æ‰¹é‡ä¸‹è½½
   - é¢„æœŸæ—¶é—´: â‰¤30ç§’å®Œæ•´æµç¨‹

3. **è¯ä¹¦éªŒè¯åœºæ™¯**
   - ç”Ÿæˆè¯ä¹¦ â†’ éªŒè¯è¯ä¹¦ â†’ å¤„ç†å¼‚å¸¸
   - é¢„æœŸç»“æœ: 100% éªŒè¯æˆåŠŸç‡

#### E2E æµ‹è¯•é…ç½®
```typescript
// Playwright E2E é…ç½®
import { test, expect } from '@playwright/test';

test.describe('æ°´å°åº”ç”¨ E2E æµ‹è¯•', () => {
  test('å®Œæ•´ç”¨æˆ·æµç¨‹', async ({ page }) => {
    await page.goto('/');
    
    // ä¸Šä¼ æ–‡ä»¶
    await page.setInputFiles('input[type="file"]', testImage);
    
    // é…ç½®æ°´å°
    await page.fill('[data-testid="watermark-text"]', 'æµ‹è¯•æ°´å°');
    await page.selectOption('[data-testid="font-size"]', '24px');
    
    // å¤„ç†å¹¶ä¸‹è½½
    await page.click('[data-testid="process-button"]');
    await page.waitForSelector('[data-testid="download-ready"]');
    
    const download = await page.waitForEvent('download');
    expect(download.suggestedFilename()).toContain('watermarked');
  });
});
```

## 3. æ€§èƒ½æµ‹è¯•ç­–ç•¥

### 3.1 åŸºå‡†æµ‹è¯•
```typescript
// æ€§èƒ½åŸºå‡†æµ‹è¯•
const performanceBenchmarks = {
  fileSize: [100, 1000, 5000, 10000], // KB
  processingTime: [500, 1500, 3000, 6000], // ms
  memoryUsage: [10, 50, 200, 500], // MB
  
  validate: (actual, expected) => {
    return actual <= expected * 1.2; // 20% tolerance
  }
};
```

### 3.2 è´Ÿè½½æµ‹è¯•åœºæ™¯
- **å¹¶å‘å¤„ç†**: åŒæ—¶å¤„ç†5ä¸ªæ–‡ä»¶
- **å¤§æ–‡ä»¶å¤„ç†**: 50MBæ–‡ä»¶æé™æµ‹è¯•
- **å†…å­˜å‹åŠ›**: è¿ç»­å¤„ç†100ä¸ªæ–‡ä»¶
- **æµè§ˆå™¨æ€§èƒ½**: ä¸åŒè®¾å¤‡æ€§èƒ½å¯¹æ¯”

## 4. å®‰å…¨æµ‹è¯•

### 4.1 è¾“å…¥éªŒè¯æµ‹è¯•
| æµ‹è¯•ç±»å‹ | æµ‹è¯•æ•°æ® | é¢„æœŸè¡Œä¸º | å®é™…ç»“æœ |
|----------|----------|----------|----------|
| **XSS æ”»å‡»** | `<script>alert('xss')</script>` | è¿‡æ»¤/è½¬ä¹‰ | âœ… é€šè¿‡ |
| **æ–‡ä»¶ç±»å‹** | .exe, .bat, .js | æ‹’ç»å¤„ç† | âœ… é€šè¿‡ |
| **æ–‡ä»¶å¤§å°** | 100MB+ | æ‹’ç»ä¸Šä¼  | âœ… é€šè¿‡ |
| **ç‰¹æ®Šå­—ç¬¦** | `../../etc/passwd` | è·¯å¾„æ¸…ç† | âœ… é€šè¿‡ |

### 4.2 è¯ä¹¦å®‰å…¨æµ‹è¯•
```typescript
// è¯ä¹¦å®‰å…¨æµ‹è¯•
import { describe, it, expect } from 'vitest';
import { CertificateManager } from '../src/security/CertificateManager';

describe('Certificate Security', () => {
  it('should prevent certificate tampering', async () => {
    const cert = await CertificateManager.generate(imageData);
    const tamperedCert = { ...cert, hash: 'tampered' };
    
    const isValid = await CertificateManager.verify(tamperedCert);
    expect(isValid).toBe(false);
  });
});
```

## 5. è‡ªåŠ¨åŒ–æµ‹è¯•æµæ°´çº¿

### 5.1 GitHub Actions é…ç½®
```yaml
name: è´¨é‡é—¨ç¦
on: [push, pull_request]

jobs:
  quality-gates:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: å®‰è£…ä¾èµ–
        run: npm ci
        
      - name: å•å…ƒæµ‹è¯•
        run: npm run test:unit -- --coverage
        
      - name: é›†æˆæµ‹è¯•
        run: npm run test:integration
        
      - name: E2E æµ‹è¯•
        run: npm run test:e2e
        
      - name: æ€§èƒ½æµ‹è¯•
        run: npm run test:performance
        
      - name: å®‰å…¨æ‰«æ
        run: npm run security:scan
        
      - name: è´¨é‡æŠ¥å‘Š
        uses: codecov/codecov-action@v3
```

### 5.2 æœ¬åœ°å¼€å‘æµ‹è¯•è„šæœ¬
```json
{
  "scripts": {
    "test": "vitest",
    "test:unit": "vitest --config vitest.config.unit.ts",
    "test:integration": "vitest --config vitest.config.integration.ts",
    "test:e2e": "playwright test",
    "test:performance": "node scripts/performance-test.js",
    "test:security": "node scripts/security-test.js",
    "test:watch": "vitest --watch",
    "test:coverage": "vitest --coverage"
  }
}
```

## 6. è´¨é‡ç›‘æ§ä»ªè¡¨æ¿

### 6.1 å…³é”®è´¨é‡æŒ‡æ ‡ (KQI)
```typescript
interface QualityDashboard {
  testCoverage: {
    lines: number;
    functions: number;
    branches: number;
  };
  performance: {
    avgProcessingTime: number;
    memoryUsage: number;
    errorRate: number;
  };
  security: {
    vulnerabilities: number;
    auditScore: number;
  };
  browser: {
    compatibility: number;
    performance: Record<string, number>;
  };
}
```

### 6.2 å®æ—¶è´¨é‡ç›‘æ§
- **æµ‹è¯•é€šè¿‡ç‡**: å®æ—¶ç›‘æ§æ‰€æœ‰æµ‹è¯•çŠ¶æ€
- **æ€§èƒ½åŸºå‡†**: æ¯æ¬¡æäº¤çš„æ€§èƒ½å¯¹æ¯”
- **å®‰å…¨æ‰«æ**: è‡ªåŠ¨ä¾èµ–æ¼æ´æ£€æµ‹
- **ä»£ç è´¨é‡**: PR è‡ªåŠ¨ä»£ç å®¡æŸ¥

## 7. é£é™©é¢„è­¦æœºåˆ¶

### 7.1 é£é™©ç­‰çº§å®šä¹‰
- **ğŸŸ¢ ä½é£é™©**: æµ‹è¯•è¦†ç›–ç‡ <80% æˆ–æ€§èƒ½ä¸‹é™ <10%
- **ğŸŸ¡ ä¸­é£é™©**: æµ‹è¯•å¤±è´¥æˆ–æ€§èƒ½ä¸‹é™ 10-20%
- **ğŸ”´ é«˜é£é™©**: å®‰å…¨æ¼æ´æˆ–æ€§èƒ½ä¸‹é™ >20%

### 7.2 è‡ªåŠ¨é¢„è­¦è§¦å‘
```typescript
// é£é™©é¢„è­¦ç³»ç»Ÿ
class RiskMonitor {
  private thresholds = {
    testCoverage: 80,
    performance: 3000, // ms
    errorRate: 0.1, // %
    securityScore: 90
  };

  async checkRisks(): Promise<RiskReport> {
    const metrics = await this.collectMetrics();
    
    return {
      level: this.calculateRiskLevel(metrics),
      recommendations: this.generateRecommendations(metrics),
      actions: this.suggestActions(metrics)
    };
  }
}
```

## 8. å‘å¸ƒå‰æ£€æŸ¥æ¸…å•

### 8.1 åŠŸèƒ½éªŒè¯æ¸…å•
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡ (â‰¥80% è¦†ç›–ç‡)
- [ ] æ‰€æœ‰é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ‰€æœ‰ E2E æµ‹è¯•é€šè¿‡
- [ ] æµè§ˆå™¨å…¼å®¹æ€§éªŒè¯
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•é€šè¿‡
- [ ] å®‰å…¨æ‰«ææ— é«˜å±æ¼æ´
- [ ] ä»£ç å®¡æŸ¥å®Œæˆ
- [ ] æ–‡æ¡£æ›´æ–°å®Œæ•´
- [ ] éƒ¨ç½²é…ç½®éªŒè¯

### 8.2 ç”¨æˆ·éªŒæ”¶æµ‹è¯• (UAT)
- [ ] åŸºç¡€åŠŸèƒ½æµ‹è¯•
- [ ] è¾¹ç•Œæ¡ä»¶æµ‹è¯•
- [ ] å¼‚å¸¸å¤„ç†æµ‹è¯•
- [ ] ç”¨æˆ·ä½“éªŒæµ‹è¯•
- [ ] æ€§èƒ½å‹åŠ›æµ‹è¯•
- [ ] å®‰å…¨æµ‹è¯•éªŒè¯

## 9. æŒç»­æ”¹è¿›è®¡åˆ’

### 9.1 è´¨é‡å›é¡¾ä¼šè®®
- **é¢‘ç‡**: æ¯ä¸¤å‘¨ Sprint ç»“æŸ
- **å‚ä¸è€…**: å¼€å‘ã€æµ‹è¯•ã€äº§å“å›¢é˜Ÿ
- **å†…å®¹**: è´¨é‡æŒ‡æ ‡å›é¡¾ã€é—®é¢˜åˆ†æã€æ”¹è¿›è®¡åˆ’

### 9.2 è´¨é‡æŒ‡æ ‡è¿½è¸ª
- **æµ‹è¯•è¦†ç›–ç‡è¶‹åŠ¿**: æ¯å‘¨ç›‘æ§
- **ç¼ºé™·å¯†åº¦**: æ¯æ¬¡å‘å¸ƒç»Ÿè®¡
- **ç”¨æˆ·åé¦ˆ**: æ¯æœˆæ”¶é›†åˆ†æ
- **æ€§èƒ½åŸºå‡†**: æŒç»­ç›‘æ§

### 9.3 è‡ªåŠ¨åŒ–æ”¹è¿›
- **æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆ**: åŸºäºä»£ç å˜æ›´
- **æ€§èƒ½åŸºå‡†åŠ¨æ€è°ƒæ•´**: æ ¹æ®å®é™…ä½¿ç”¨æ•°æ®
- **å®‰å…¨æ‰«æå¢å¼º**: æ–°æ¼æ´è‡ªåŠ¨æ£€æµ‹
- **ç”¨æˆ·ä½“éªŒç›‘æ§**: çœŸå®ç”¨æˆ·è¡Œä¸ºåˆ†æ

---

**è´¨é‡æ‰¿è¯º**: æ‰€æœ‰åŠŸèƒ½åœ¨å‘å¸ƒå‰å¿…é¡»é€šè¿‡å®Œæ•´çš„è´¨é‡é—¨ç¦ï¼Œç¡®ä¿ä¸ºç”¨æˆ·æä¾›ç¨³å®šã€å®‰å…¨ã€é«˜æ€§èƒ½çš„äº§å“ä½“éªŒã€‚